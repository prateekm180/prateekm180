#include <iostream>
#include <string>
#include <bits/stdc++.h>
int comparisons = 0;
int randomization(int size) {
uint64_t seed =
std::chrono::high_resolution_clock::now().time_since_epoch().count() ^
std::random_device{}() ^
(uint64_t) std::rand();
static std::mt19937_64 gen(seed);
std::uniform_int_distribution<int> dist(0, size - 1);
return dist(gen);
}
void printArray(int arr[], int size) {
for (int i = 0; i < size; i++) std::cout << arr[i] << " ";
std::cout << std::endl;
}
int randomized_partition(int arr[], int low, int high) {
int random_index = low + randomization(high - low + 1);
std::swap(arr[random_index], arr[high]);
int pivot = arr[high];
int i = low - 1;
for (int j = low; j < high; j++) {
comparisons++; 
if (arr[j] <= pivot) {
i++;
std::swap(arr[i], arr[j]);
}
}
std::swap(arr[i + 1], arr[high]);
return i + 1;
}
void randomized_quickSort(int arr[], int low, int high, int size) {
if (low < high) {
int p = randomized_partition(arr, low, high);
std::cout << "Pivot placed at index " << p << " -> ";
printArray(arr, size);
randomized_quickSort(arr, low, p - 1, size);
randomized_quickSort(arr, p + 1, high, size);
}
}
int randomized_select(int arr[], int low, int high, int targetIndex) {
if (low == high) return arr[low];
int q = randomized_partition(arr, low, high);
int k = q - low + 1; 
if (targetIndex == k) return arr[q];
else if (targetIndex < k) return randomized_select(arr, low, q - 1, 
targetIndex);
else return randomized_select(arr, q + 1, high, targetIndex - k);
}
int main() {
std::string choice;
do {
int size, i;
std::cout << "\nEnter size of array: ";
std::cin >> size;
std::cout << "Enter i (1 = smallest, n = largest): ";
std::cin >> i;
int arr[size];
std::cout << "Enter elements: ";
for (int i = 0; i < size; i++) std::cin >> arr[i];
std::cout << "Unsorted array : ";
printArray(arr, size);
std::cout << std::endl;
randomized_quickSort(arr, 0, size - 1, size);
std::cout << "\nSorted array: ";
printArray(arr, size);
std::cout << "Total number of comparisons = " << comparisons << std::endl;
if (i < 1 || i > size) std::cout << "Invalid i!" << std::endl; 
comparisons = 0;
int result = randomized_select(arr, 0, size - 1, i);
std::cout << "\nThe " << i << "-th smallest element is: " << result <<
std::endl;
std::cout << "Total comparisons: " << comparisons << std::endl;
std::cout << "\nDo you want to continue (Yes/No): ";
std::cin >> choice;
} while (choice == "Yes" || choice == "yes");
}
